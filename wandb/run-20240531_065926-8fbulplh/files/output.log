/root/miniconda3/envs/idm/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
{'thresholding', 'variance_type', 'dynamic_thresholding_ratio', 'clip_sample_range'} was not found in config. Values will be initialized to default values.
/root/miniconda3/envs/idm/lib/python3.10/site-packages/huggingface_hub/file_download.py:1132: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
The config attributes {'decay': 0.9999, 'inv_gamma': 1.0, 'min_decay': 0.0, 'optimization_step': 37000, 'power': 0.6666666666666666, 'update_after_step': 0, 'use_ema_warmup': False} were passed to UNet2DConditionModel, but are not expected and will be ignored. Please verify your config.json configuration file.
{'dropout', 'reverse_transformer_layers_per_block'} was not found in config. Values will be initialized to default values.
{'dropout', 'attention_type', 'addition_embed_type', 'reverse_transformer_layers_per_block'} was not found in config. Values will be initialized to default values.
Some weights of the model checkpoint were not used when initializing UNet2DConditionModel:
 ['add_embedding.linear_1.bias, add_embedding.linear_1.weight, add_embedding.linear_2.bias, add_embedding.linear_2.weight']
{'image_encoder'} was not found in config. Values will be initialized to default values.
Loading pipeline components...: 100%|███████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 434.45it/s]









 27%|█████████████████████████████▌                                                                                 | 8/30 [00:38<01:45,  4.78s/it]
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f88ae6192d0>
Traceback (most recent call last):
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1478, in __del__
    self._shutdown_workers()
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 1442, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/root/miniconda3/envs/idm/lib/python3.10/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/root/miniconda3/envs/idm/lib/python3.10/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
  File "/root/miniconda3/envs/idm/lib/python3.10/multiprocessing/connection.py", line 936, in wait
    ready = selector.select(timeout)
  File "/root/miniconda3/envs/idm/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt:
Traceback (most recent call last):
  File "/notebooks/ayna/working_repo/IDM-VTON/train.py", line 337, in <module>
    main()
  File "/notebooks/ayna/working_repo/IDM-VTON/train.py", line 334, in main
    train(args, train_dataloader, model, unet, image_encoder, optimizer, accelerator)
  File "/notebooks/ayna/working_repo/IDM-VTON/train.py", line 194, in train
    images = model(
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/notebooks/ayna/working_repo/IDM-VTON/src/tryon_pipeline.py", line 1799, in __call__
    noise_pred = self.unet(
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/notebooks/ayna/working_repo/IDM-VTON/src/unet_hacked_tryon.py", line 1361, in forward
    sample ,curr_garment_feat_idx= upsample_block(
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/notebooks/ayna/working_repo/IDM-VTON/src/unet_block_hacked_tryon.py", line 2380, in forward
    hidden_states,curr_garment_feat_idx = attn(
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/notebooks/ayna/working_repo/IDM-VTON/src/transformerhacked_tryon.py", line 397, in forward
    hidden_states,curr_garment_feat_idx = block(
  File "/root/miniconda3/envs/idm/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/notebooks/ayna/working_repo/IDM-VTON/src/attentionhacked_tryon.py", line 334, in forward
    modify_norm_hidden_states = torch.cat([norm_hidden_states,garment_features[curr_garment_feat_idx]], dim=1)
KeyboardInterrupt